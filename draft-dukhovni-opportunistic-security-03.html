<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Opportunistic Security: Some Protection Most of the Time</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology"/>
<link href="#rfc.section.3" rel="Chapter" title="3 The Opportunistic Security Design Pattern"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Opportunistic Security Design Principles"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Example: Opportunistic TLS in SMTP"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgements"/>
<link href="#rfc.references" rel="Chapter" title="8 References"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.4.4 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Dukhovni, V." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-dukhovni-opportunistic-security-03" />
  <meta name="dct.issued" scheme="ISO8601" content="2014-8-12" />
  <meta name="dct.abstract" content="This memo introduces the &quot;Opportunistic Security&quot; (OS) protocol design pattern.  Protocol designs based on OS depart from the established practice of employing cryptographic protection against both passive and active attacks, or no protection at all.  OS protocols tailor the minimum acceptable channel security to the capabilities of the peer systems.  As a result, at least some cryptographic protection is provided most of the time.  " />
  <meta name="description" content="This memo introduces the &quot;Opportunistic Security&quot; (OS) protocol design pattern.  Protocol designs based on OS depart from the established practice of employing cryptographic protection against both passive and active attacks, or no protection at all.  OS protocols tailor the minimum acceptable channel security to the capabilities of the peer systems.  As a result, at least some cryptographic protection is provided most of the time.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">Network Working Group</td>
  <td class="right">V. Dukhovni</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">Two Sigma</td>
</tr>
<tr>
  <td class="left">Intended status: Informational</td>
  <td class="right">August 12, 2014</td>
</tr>
<tr>
  <td class="left">Expires: February 13, 2015</td>
  <td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Opportunistic Security: Some Protection Most of the Time<br />
  <span class="filename">draft-dukhovni-opportunistic-security-03</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This memo introduces the "Opportunistic Security" (OS) protocol design pattern.  Protocol designs based on OS depart from the established practice of employing cryptographic protection against both passive and active attacks, or no protection at all.  OS protocols tailor the minimum acceptable channel security to the capabilities of the peer systems.  As a result, at least some cryptographic protection is provided most of the time.  </p>
<p>This document is aimed primarily at protocol designers.  It facilitates designs that are more resistant to passive wiretaps, and designs in which cryptographic protection against active attacks can be rolled out incrementally as suitably capable systems are deployed.  Another audience is operators who set policy for systems that can implement opportunistic security.  </p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on February 13, 2015.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2014 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>2.   <a href="#rfc.section.2">Terminology</a></li>
<li>3.   <a href="#rfc.section.3">The Opportunistic Security Design Pattern</a></li>
<li>4.   <a href="#rfc.section.4">Opportunistic Security Design Principles</a></li>
<li>5.   <a href="#rfc.section.5">Example: Opportunistic TLS in SMTP</a></li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a></li>
<li>7.   <a href="#rfc.section.7">Acknowledgements</a></li>
<li>8.   <a href="#rfc.references">References</a></li>
<li><a href="#rfc.authors">Author's Address</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">Encryption is easy, but key management is difficult.  For example, the Public Key Infrastructure (PKI) used for the web (often called the "Web PKI") is based on broadly trusted public certification authorities (CAs).  The Web PKI has too many fully trusted authorities and imposes burdens that not all peers are willing to bear.  Web PKI public CAs are not always sufficient to authenticate the peer system.  Web PKI authentication is vulnerable to MiTM attacks when the peer reference identifier (<a href="#RFC6125">[RFC6125]</a>) is obtained indirectly over an insecure channel, perhaps via an MX or SRV lookup.  And with so many certification authorities the communicating parties don't always agree on a mutually trusted CA.  </p>
<p id="rfc.section.1.p.2">At this time, DNS Security (DNSSEC <a href="#RFC4033">[RFC4033]</a>) is not sufficiently widely adopted to make DNS-Based Authentication of Named Entities (DANE <a href="#RFC6698">[RFC6698]</a>) a viable ubiquitous alternative to CAs.  Trust on first use (TOFU) key management models (such as saved SSH fingerprints and various certificate pinning approaches) don't protect initial contact, and require more user intervention when keys change unexpectedly.  </p>
<p id="rfc.section.1.p.3">Historically, Internet security protocols have prioritized comprehensive cryptographic protection against both passive and active attacks over enabling systems with varied security requirements to communicate with each other.  Protection against active attacks requires authentication, but the lack of a universal key management approach has created a situation in which only a minority of peers can be authenticated.  When protocols only offer the options of an authenticated secure channel or cleartext, most traffic is sent in the clear.  As a result, while communications traffic is sometimes strongly protected, more typically it is not protected at all.  The fact that most traffic is unencrypted makes pervasive monitoring easier by making it cost-effective, or at least not cost-prohibitive; see <a href="#RFC7258">[RFC7258]</a> for more detail.  </p>
<p id="rfc.section.1.p.4">If security protocols were designed to encrypt traffic whenever possible, bulk collection of communications traffic would be substantially less attractive.  Even if one is not concerned about pervasive monitoring, passive wiretaps by individual malicious actors or criminal organizations are still a potential problem for individuals and organizations.  Using the opportunistic security design makes passive attacks more difficult for all these actors.  </p>
<p id="rfc.section.1.p.5">In order to make encryption more ubiquitous, authentication should not be required where it cannot be expected.  Against the background of pervasive monitoring and other passive attacks, when authenticated communication is not possible, unauthenticated encryption is preferable to cleartext.  The opportunistic security design pattern promotes stepping up from cleartext, not down from authenticated encryption.  Opportunistic security encourages peers to employ as much security as possible, without falling back on unnecessarily weak options.  In particular, opportunistic security encourages unauthenticated encryption rather than cleartext when authentication is not an option.  </p>
<p id="rfc.section.1.p.6">The risk of active attacks should also not be ignored.  The opportunistic security design pattern features a range of cryptographic protection levels, with encrypted transmission accessible to most if not all peers.  Even with opportunistic security, protection against active attacks is still employed where unconditionally required by local policy or else determined to be applicable with a given peer.  Protocol designers are encouraged to produce protocols that can securely determine which peers support authentication, and can then establish authenticated communication channels resistant to active attacks with those peers.  However, opportunistically applied authentication must avoid deployment roadblocks and needs to be designed with care to "just work".  </p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#sec_terminology" id="sec_terminology">Terminology</a></h1>
<p/>

<dl>
  <dt>Perfect Forward Secrecy (PFS):</dt>
  <dd style="margin-left: 8">As defined in <a href="#RFC4949">[RFC4949]</a>.  </dd>
  <dt>Man-in-the-Middle (MiTM) attack:</dt>
  <dd style="margin-left: 8">As defined in <a href="#RFC4949">[RFC4949]</a>.  </dd>
  <dt>Trust on First Use (TOFU):</dt>
  <dd style="margin-left: 8">In a protocol, TOFU typically consists of accepting an asserted identity, without authenticating that assertion, and caching a key or credential associated with the identity.  Subsequent communication using the cached key/credential is secure against an MiTM attack, if such an attack did not succeed during the (vulnerable) initial communication or if the MiTM is not present for all subsequent communications.  The SSH protocol makes use of TOFU. The phrase "leap of faith" (LoF) is sometimes used as a synonym.  </dd>
  <dt>Unauthenticated Encryption:</dt>
  <dd style="margin-left: 8">Encryption using a key agreement scheme that does not authenticate the identities of the peers.  In typical usage, this means that the initiator (client) has not verified the identity of the target (server), making MiTM attacks possible.  Note that unauthenticated encryption is not the opposite of Authenticated Encryption with Associated Data (AEAD, <a href="#RFC5116">[RFC5116]</a>), AEAD algorithms can be used with either authenticated or unauthenticated peers.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> The Opportunistic Security Design Pattern</h1>
<p id="rfc.section.3.p.1">Opportunistic Security is a protocol design pattern that aims to remove barriers to the widespread use of encryption on the Internet.  </p>
<p id="rfc.section.3.p.2">The opportunistic security design pattern involves using the advertised capabilities of communicating peers, either in-band or out-of band, to determine what security mechanisms are used and how.  This includes the specific mechanisms, whether to require their use, how to handle errors and what to do when mechanisms are disabled.  </p>
<p id="rfc.section.3.p.3">Security services that "just work" are more likely to be deployed and enabled by default.  When the advertised capabilities of peers match reality, an opportunistic security design avoids causing communications issues that would otherwise prevent the deployment of protocol security.  </p>
<p id="rfc.section.3.p.4">The determination of which security mechanisms to use can vary from case to case when the OS design pattern is used with different protocols.  The protection provided by the OS pattern will depend on the protocol making use of the pattern.  In many cases, OS will result in negotiating channels with one of the following security properties: </p>

<ul>
  <li>No encryption (cleartext), which protects against neither passive nor active attacks.  </li>
  <li>Unauthenticated encryption, which protects only against passive attacks.  </li>
  <li>Authenticated encryption, which protects against both passive and active attacks.  </li>
</ul>

<p> </p>
<p id="rfc.section.3.p.5">Opportunistic security does not start with an overly optimistic view of peer capabilities only to be "disappointed" and settle for less when the peer fails to live up to expectations.  Rather, the opportunistic security design pattern starts with a pessimistic view of the baseline capabilities of all peers, and is "pleasantly surprised" to learn that some peers can be expected to do more.  Opportunistic security aims to do better than might be expected, rather than worse than might be hoped.  </p>
<p id="rfc.section.3.p.6">Enforcement of authentication in an opportunistic protocol is not a contradiction.  Opportunistic security protocols should provide a means to enforce authentication for those peers for which authentication is required by policy or can be expected to succeed based on information advertised by the peer via DANE, TOFU or other means.  With DANE, the advertisement that a peer supports authentication is downgrade-resistant.  </p>
<p id="rfc.section.3.p.7">Unless preempted by local or other policy, an opportunistic security protocol first determines the capabilities of a peer.  This might include whether that peer supports authenticated encryption, unauthenticated encryption or perhaps only cleartext.  The appropriate communications security policy is then employed for each peer.  An OS protocol may apply more stringent security settings with the underlying cryptographic mechanisms when authenticated encryption is required than when only unauthenticated encryption is employed.  </p>
<p id="rfc.section.3.p.8">Authentication failure can be a reason to abort a connection to a peer that is expected to be authenticated.  However, such a failure must not then lead to communication in cleartext when encryption is an option.  For example, some Message Transfer Agents (MTAs, <a href="#RFC5598">[RFC5598]</a> Section 4.3.2) employing STARTTLS (<a href="#RFC3207">[RFC3207]</a>) have been observed to abandon Transport Layer Security (TLS) <a href="#RFC5246">[RFC5246]</a> encrypted transmission when the receiving MTA fails authentication, only to immediately deliver the same message over a cleartext connection.  The OS design pattern avoids this obvious problem.  </p>
<p id="rfc.section.3.p.9">Cleartext support is for backwards compatibility with already deployed systems.  Cleartext transmission should be avoided in new OS protocol designs.  Even when cleartext needs to be supported, protocol designs based on opportunistic security prefer to encrypt, allowing fallback to cleartext with peers that do not appear to be encryption capable.  </p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> Opportunistic Security Design Principles</h1>
<p/>

<dl>
  <dt>Coexist with explicit policy:</dt>
  <dd style="margin-left: 8">Explicit security policy preempts opportunistic behavior.  Administrators or users may elect to disable opportunistic security for some or all peers and set a fixed security policy not based on capabilities advertised or published by the peer.  Alternatively, opportunistic security might be enabled only for specified peers, rather than by default.  Opportunistic security is not intended to displace or preempt local policy.  </dd>
  <dt>Prioritize not getting in the way:</dt>
  <dd style="margin-left: 8">The primary goal of designs that feature opportunistic security is to enable communication and maximize deployment.  If a non-negligible number of potential peers are only capable of cleartext, then it is acceptable to fall back to cleartext when encryption is not possible.  If authentication is only possible for some peers, then it is acceptable to authenticate only those peers and not the rest.  Opportunistic security needs to be deployable incrementally, with each peer deployed and configured independently by its administrator or user.  Opportunistic security must not get in the way of two peers communicating when neither advertises or negotiates security services that are not available or don't function correctly.  </dd>
  <dt>Maximize security peer by peer:</dt>
  <dd style="margin-left: 8">Opportunistic security strives to maximize security based on the capabilities of the peers.  Opportunistic security protocols may, when applicable, refuse to communicate with peers for which higher security is expected, but for some reason not achieved.  The conditions under which connections fail should generally be limited to operational errors at one or the other peer or an active attack, so that well-maintained systems rarely encounter problems in normal use of opportunistic security.  </dd>
  <dt>Encrypt by default:</dt>
  <dd style="margin-left: 8">An opportunistic security protocol at least encrypts communications.  Opportunistic security protocols may tolerate cleartext only to ensure successful communication with legacy peers that don't support encryption or when encryption is disabled by local policy.  Whenever possible, opportunistic security should employ Perfect Forward Secrecy (PFS) to make recovery of previously sent keys and plaintext computationally expensive even after disclosure of long-term keys.  </dd>
  <dt>No misrepresentation of security:</dt>
  <dd style="margin-left: 8">Unauthenticated encrypted communication must not be misrepresented as communication over a secure channel.  </dd>
</dl>

<p> </p>
<p id="rfc.section.4.p.2">In summary, the opportunistic security design pattern encompasses protocol designs that remove barriers to the widespread use of encryption on the Internet.  The actual protection provided by opportunistic security depends on the advertised capabilities of the communicating peers.  Opportunistic security aims to encrypt all network traffic, while allowing fallback to cleartext with peers that do not appear to be encryption capable.  </p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> Example: Opportunistic TLS in SMTP</h1>
<p id="rfc.section.5.p.1">Many MTAs support the STARTTLS (<a href="#RFC3207">[RFC3207]</a>) ESMTP extension, however STARTTLS support is not yet universal.  In the absence of local policy to the contrary, MTAs acting as SMTP clients are generally willing to send email in cleartext, but will employ TLS when the SMTP server's EHLO response advertises STARTTLS support.  Since the EHLO response is not cryptographically protected, this advertisement is vulnerable to MiTM downgrade attacks.  Thus opportunistic TLS based on STARTTLS support can only protect against passive attacks, and MTAs do not generally require peer authentication.  Self-signed certificates are common on receiving MTAs, and the server name is generally obtained via insecure MX lookups.  </p>
<p id="rfc.section.5.p.2">Therefore, MTAs that implement opportunistic TLS employ at most unauthenticated encryption, or else deliver over a cleartext channel.  However, recent reports from a number of large providers suggest that the majority of SMTP email transmission on the Internet is now encrypted.  And the trend is toward increasing adoption.  </p>
<p id="rfc.section.5.p.3">Not only is the STARTTLS advertisement is vulnerable to active attacks, but also at present some MTAs that advertise STARTTLS exhibit various interoperability problems in their implementations.  As a result, it is common practice to fall back to cleartext transmission not only when STARTTLS is not offered, but also when the TLS handshake fails, or even when TLS fails during message transmission.  </p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#sec_security" id="sec_security">Security Considerations</a></h1>
<p id="rfc.section.6.p.1">Though opportunistic security potentially supports transmission in cleartext, unauthenticated encryption, or other cryptographic protection levels short of the strongest potentially applicable, the effective security for peers is always increased and never reduced.  If a cryptographic capability is neither required by policy nor supported by the peer, nothing is lost by going without.  Opportunistic security is strictly stronger than the alternative of providing no security services when maximal security is not applicable.  </p>
<p id="rfc.section.6.p.2">Opportunistic security does not require reducing security policy to the lowest common denominator.  Opportunistic security coexists with and is preempted by any a-priori security policy that is not based on advertised peer capabilities.  However, such a-priori policy can be counter-productive when it expects more than most peers can in fact deliver.  A-priori policy should be used with care, lest users find it too restrictive and act to disable security entirely.  Opportunistic security aims to enable incremental rollout of cryptographic protection against both passive and active attacks as appropriate software and configurations are deployed one system at a time.  </p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a></h1>
<p id="rfc.section.7.p.1">I would like to thank Steve Kent.  Some of the text in this document is based on his earlier draft.  I would also like to thank Nico Williams, Paul Hoffman, Martin Thomson, Scott Kitterman, Paul Wouters and Stephen Farrell for their helpful suggestions and support.  </p>
<h1 id="rfc.references"><a href="#rfc.references">8.</a> References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC3207">[RFC3207]</b>
      </td>
      <td class="top"><a>Hoffman, P.</a>, "<a href="http://tools.ietf.org/html/rfc3207">SMTP Service Extension for Secure SMTP over Transport Layer Security</a>", RFC 3207, February 2002.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4033">[RFC4033]</b>
      </td>
      <td class="top"><a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>", RFC 4033, March 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4949">[RFC4949]</b>
      </td>
      <td class="top"><a>Shirey, R.</a>, "<a href="http://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>", RFC 4949, August 2007.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5116">[RFC5116]</b>
      </td>
      <td class="top"><a>McGrew, D.</a>, "<a href="http://tools.ietf.org/html/rfc5116">An Interface and Algorithms for Authenticated Encryption</a>", RFC 5116, January 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5246">[RFC5246]</b>
      </td>
      <td class="top"><a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5598">[RFC5598]</b>
      </td>
      <td class="top"><a>Crocker, D.</a>, "<a href="http://tools.ietf.org/html/rfc5598">Internet Mail Architecture</a>", RFC 5598, July 2009.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6125">[RFC6125]</b>
      </td>
      <td class="top"><a>Saint-Andre, P.</a> and <a>J. Hodges</a>, "<a href="http://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>", RFC 6125, March 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6698">[RFC6698]</b>
      </td>
      <td class="top"><a>Hoffman, P.</a> and <a>J. Schlyter</a>, "<a href="http://tools.ietf.org/html/rfc6698">The DNS-Based Authentication of Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA</a>", RFC 6698, August 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7258">[RFC7258]</b>
      </td>
      <td class="top"><a>Farrell, S.</a> and <a>H. Tschofenig</a>, "<a href="http://tools.ietf.org/html/rfc7258">Pervasive Monitoring Is an Attack</a>", BCP 188, RFC 7258, May 2014.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Author's Address</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Viktor Dukhovni</span> 
	  <span class="n hidden">
		<span class="family-name">Dukhovni</span>
	  </span>
	</span>
	<span class="org vcardline">Two Sigma</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ietf-dane@dukhovni.org">ietf-dane@dukhovni.org</a></span>

  </address>
</div>

</body>
</html>
